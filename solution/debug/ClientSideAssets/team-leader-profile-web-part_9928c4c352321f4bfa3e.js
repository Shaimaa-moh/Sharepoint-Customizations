define(["@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","TeamLeaderProfileWebPartStrings"],(e,t,n,a)=>(()=>{"use strict";var i={676:t=>{t.exports=e},877:e=>{e.exports=t},642:e=>{e.exports=n},982:e=>{e.exports=a}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{default:()=>St});var e=o(676),t=o(877),n=o(642);function a(e,t,n){let a=new Date(e.toString());switch(t.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+n);break;case"quarter":a.setMonth(a.getMonth()+3*n);break;case"month":a.setMonth(a.getMonth()+n);break;case"week":a.setDate(a.getDate()+7*n);break;case"day":a.setDate(a.getDate()+n);break;case"hour":a.setTime(a.getTime()+36e5*n);break;case"minute":a.setTime(a.getTime()+6e4*n);break;case"second":a.setTime(a.getTime()+1e3*n);break;default:a=void 0}return a}function i(...e){return e.filter(e=>!u(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function r(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function c(e){return"function"==typeof e}function d(e){return Array.isArray(e)}function l(e){return/^https?:\/\/|^\/\//i.test(e)}function u(e){return null==e||e.length<1}function f(e){return null!=e}function p(e){return JSON.stringify(e)}function m(e,t){return Object.hasOwnProperty.call(e,t)}let _;function h(){return void 0===_&&(_=new g),_}class b{constructor(e){this.store=e,this.enabled=this.test()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!f(t))return null;const n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}put(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}delete(e){this.enabled&&this.store.removeItem(e)}async getOrPut(e,t,n){if(!this.enabled)return t();let a=this.get(e);return null===a&&(a=await t(),this.put(e,a,n)),a}async deleteExpired(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&await this.get(t)}}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){return void 0===t&&(t=a(new Date,"minute",5)),p({pnp:1,expiration:t,value:e})}}class g{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}function v(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function y(){return async function(e,...t){return[...e].reduce((e,t)=>e.then(e=>Reflect.apply(t,this,e)),Promise.resolve(t))}}function S(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t);return this}}const D=Symbol.for("ObserverLifecycleFlags"),I=e=>t=>!((t[D]||0)&e),x=e=>t=>(t[D]=(t[D]||0)|e,t);x(1),x(2);class C{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),O(e.observers,t,n,1),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),O(e.observers,t,n,3),e),prepend:n=>(e.cloneObserversOnChange(),O(e.observers,t,n,2),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){f(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!d(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?S():v();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}finally{a&&a.length>0&&Reflect.set(e.observers,t,a.filter(I(2)))}}})),this._emitProxy}start(e){this.emit.init();const t=this.execute(e);return t.finally(()=>{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}).catch(()=>{}),t}cloneObserversOnChange(){this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=w(this.observers))}}function O(e,t,n,a){if(!c(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case 1:e[t].push(n);break;case 2:e[t].unshift(n);break;case 3:e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}function w(e){return Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n].filter(I(1))],t),{})}function E(e,t="append",n){return a=>Reflect.apply(A,a,[e,t,n])}function A(e,t,n){if(!f(e)||!f(e.observers))return this;c(n)||(n=()=>!0);const a=w(e.observers),i=Object.keys(a).filter(n);for(let e=0;e<i.length;e++){const n=i[e],r=this.on[n];"replace"===t&&r.clear(),a[n].forEach(e=>r(e))}return this}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const L={construct:S(),pre:y(),auth:y(),send:async function(e,...t){if(!d(e)||e.length<1)return;const n=e[0];return Reflect.apply(n,this,t)},parse:y(),post:y(),data:v()};let k=class extends C{constructor(e,t){let n;if(super(L),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=function(e,...t){return[...e].reduce((e,t)=>Reflect.apply(t,this,e),t)},"string"==typeof e)this._url=i(e,t);else if(d(e)){if(2!==e.length)throw Error("When using the tuple param exactly two arguments are expected.");if("string"!=typeof e[1])throw Error("Expected second tuple param to be a string.");n=e[0],this._url=i(e[1],t)}else n=e,this._url=i(n._url,t);void 0!==n&&(this.observers=n.observers,this._inheritingObservers=!0)}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();const t=this.query.toString();return u(t)||(e+=`${e.indexOf("?")>-1?"&":"?"}${t}`),e}get query(){return this._query}toUrl(){return this._url}execute(e){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");return setTimeout(async()=>{const t=r();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",0);const i={...e,headers:{...e.headers,"X-PnPjs-RequestId":t}};let[r,o,s]=await this.emit.pre(this.toRequestUrl(),i,void 0);if(a(`Url: ${r}`,1),void 0!==s)return a("Result returned from pre, Emitting data"),this.emit.data(s),void a("Emitted data");a("Emitting auth"),[n,o]=await this.emit.auth(new URL(r),o),a("Emitted auth"),o={...o,...e,headers:{...o.headers,...e.headers}},a("Emitting send");let c=await this.emit.send(n,o);a("Emitted send"),a("Emitting parse"),[n,c,s]=await this.emit.parse(n,c,s),a("Emitted parse"),a("Emitting post"),[n,s]=await this.emit.post(n,s),a("Emitted post"),a("Emitting data"),this.emit.data(s),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",0)}},0),this.emit[this.InternalPromise](new Promise((e,t)=>{this.on[this.InternalResolve].replace(e),this.on[this.InternalReject].replace(t)}))[0]}};var M;function P(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function T(e){return this.start(P("GET",e))}function U(e){return this.start(P("POST",e))}function F(e,t,n){return Reflect.apply(t,e,[n])}async function H(e,t,n){if(!t.ok)throw await B.init(t);return[e,t,n]}function R(e){let t=e;return m(e,"d")?t=m(e.d,"results")?e.d.results:e.d:m(e,"value")&&(t=e.value),t}function N(e){return t=>(t.on.parse.replace(H),t.on.parse(async(t,n,a)=>(n.ok&&void 0===a&&(a=await e(n)),[t,n,a])),t)}k=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([e=>new Proxy(e,{construct(e,t,n){const a=Object.assign(function(e){return c(M)||(M=function(e){return F(this,T,e)}),Reflect.apply(M,a,[e])},Reflect.construct(e,t,n));return Reflect.setPrototypeOf(a,n.prototype),a}})],k);class B extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.clone().text();return new B(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e)}}function j(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function V(e,t){return Object.assign({body:p(e)},t)}function z(e,t){return Object.assign({},t,{headers:{...null==t?void 0:t.headers,...e}})}new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new b("undefined"==typeof localStorage?h():localStorage)),this._local}get session(){return null===this._session&&(this._session=new b("undefined"==typeof sessionStorage?h():sessionStorage)),this._session}},Symbol.for("CancelScopeId"),new Map;const G=e=>{return t=e,(e,n)=>{const a=new t(e,n);return a.emit.construct(e,n),a};var t};class K extends k{constructor(e,t){if("string"==typeof e){let n="",a="";if(l(e)||e.lastIndexOf("/")<0)a=e,n=i(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const r=e.lastIndexOf("/");a=e.slice(0,r),t=i(e.slice(r),t),n=i(a,t)}else{const r=e.lastIndexOf("(");a=e.slice(0,r),n=i(e,t)}super(n),this.parentUrl=a}else{super(e,t);const n=d(e)?e[0]:e;this.parentUrl=d(e)?e[1]:n.toUrl()}}toRequestUrl(){const e=new URLSearchParams(this.query);let t=this.toUrl().replace(/'!(@.+?)::((?:[^']|'')+)'/gi,(t,n,a)=>(this.log(`Rewriting aliased parameter from match ${t} to label: ${n} value: ${a}`,0),e.set(n,`'${a}'`),n));const n=e.toString();return u(n)||(t+=`${t.indexOf("?")>-1?"&":"?"}${n}`),t}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t,n=this.parentUrl){return e([this,n],t)}}const W=G(K);class q extends K{filter(e){return"object"==typeof e?(this.query.set("$filter",e.toString()),this):"function"==typeof e?(this.query.set("$filter",e(ce.Where()).toString()),this):(this.query.set("$filter",e.toString()),this)}orderBy(e,t=!0){const n="$orderby",a=this.query.has(n)?this.query.get(n).split(","):[];return a.push(`${e} ${t?"asc":"desc"}`),this.query.set(n,a.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const Q=G(q);class Y extends K{}const J=G(Y);function X(){return function(){return te(this)}}function Z(){return function(e="*"){return ne(this,{},e)}}const $=(e,t)=>F(e,U,t),ee=(e,t)=>((t=t||{}).headers={...t.headers,"X-HTTP-Method":"MERGE"},$(e,t)),te=(e,t)=>((t=t||{}).headers={...t.headers||{},"X-HTTP-Method":"DELETE"},$(e,t)),ne=(e,t,n="*")=>((t=t||{}).headers={...t.headers||{},"IF-Match":n},te(e,t));var ae,ie,re,oe,se;!function(e){e.Equals="eq",e.NotEquals="ne",e.GreaterThan="gt",e.GreaterThanOrEqualTo="ge",e.LessThan="lt",e.LessThanOrEqualTo="le",e.StartsWith="startswith",e.SubstringOf="substringof"}(ae||(ae={})),function(e){e.And="and",e.AndWithSpace=" and ",e.Or="or",e.OrWithSpace=" or "}(ie||(ie={}));class ce{static Where(){return new pe([])}}class de{constructor(e){this.query=[],this.query=e}}class le extends de{constructor(e){super(e)}text(e){return new be([...this.query,e])}choice(e){return new be([...this.query,e])}multiChoice(e){return new be([...this.query,e])}number(e){return new ye([...this.query,e])}date(e){return new Se([...this.query,e])}boolean(e){return new ge([...this.query,e])}lookup(e){return new me([...this.query],e)}lookupId(e){const t=e.endsWith("Id")?e:`${e}Id`;return new ye([...this.query,t])}}class ue extends le{or(...e){return new De([...this.query,`(${e.map(e=>e.toString()).join(ie.OrWithSpace)})`])}}class fe extends le{and(...e){return new De([...this.query,`(${e.map(e=>e.toString()).join(ie.AndWithSpace)})`])}}class pe extends le{or(...e){return null==e||0===e.length?new le([...this.query,ie.Or]):new De([...this.query,`(${e.map(e=>e.toString()).join(ie.OrWithSpace)})`])}and(...e){return null==e||0===e.length?new le([...this.query,ie.And]):new De([...this.query,`(${e.map(e=>e.toString()).join(ie.AndWithSpace)})`])}}class me extends de{constructor(e,t){super(e),this.LookupField=t}Id(e){return new De([...this.query,`${this.LookupField}/Id`,ae.Equals,e.toString()])}text(e){return new be([...this.query,`${this.LookupField}/${e}`])}number(e){return new ye([...this.query,`${this.LookupField}/${e}`])}}class _e extends de{constructor(e){super(e),this.LastIndex=e.length-1,this.InternalName=e[this.LastIndex]}toODataValue(e){return`'${e}'`}isNull(){return new De([...this.query,ae.Equals,"null"])}isNotNull(){return new De([...this.query,ae.NotEquals,"null"])}}class he extends _e{equals(e){return new De([...this.query,ae.Equals,this.toODataValue(e)])}notEquals(e){return new De([...this.query,ae.NotEquals,this.toODataValue(e)])}in(...e){return ce.Where().or(...e.map(e=>this.equals(e)))}notIn(...e){return ce.Where().and(...e.map(e=>this.notEquals(e)))}}class be extends he{startsWith(e){const t=`${ae.StartsWith}(${this.InternalName}, ${this.toODataValue(e)})`;return this.query[this.LastIndex]=t,new De([...this.query])}contains(e){const t=`${ae.SubstringOf}(${this.toODataValue(e)}, ${this.InternalName})`;return this.query[this.LastIndex]=t,new De([...this.query])}}class ge extends _e{toODataValue(e){return`${null==e?"null":e?1:0}`}isTrue(){return new De([...this.query,ae.Equals,this.toODataValue(!0)])}isFalse(){return new De([...this.query,ae.Equals,this.toODataValue(!1)])}isFalseOrNull(){const e=`(${[this.InternalName,ae.Equals,this.toODataValue(null),ie.Or,this.InternalName,ae.Equals,this.toODataValue(!1)].join(" ")})`;return this.query[this.LastIndex]=e,new De([...this.query])}}class ve extends he{greaterThan(e){return new De([...this.query,ae.GreaterThan,this.toODataValue(e)])}greaterThanOrEquals(e){return new De([...this.query,ae.GreaterThanOrEqualTo,this.toODataValue(e)])}lessThan(e){return new De([...this.query,ae.LessThan,this.toODataValue(e)])}lessThanOrEquals(e){return new De([...this.query,ae.LessThanOrEqualTo,this.toODataValue(e)])}}class ye extends ve{toODataValue(e){return`${e}`}}class Se extends ve{toODataValue(e){return`'${e.toISOString()}'`}isBetween(e,t){const n=`(${[this.InternalName,ae.GreaterThan,this.toODataValue(e),ie.And,this.InternalName,ae.LessThan,this.toODataValue(t)].join(" ")})`;return this.query[this.LastIndex]=n,new De([...this.query])}isToday(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;return t.setHours(23,59,59,999),this.isBetween(e,t)}}class De extends de{and(...e){return null==e||0===e.length?new ue([...this.query,ie.And]):new De([...this.query,ie.And,`(${e.map(e=>e.toString()).join(ie.AndWithSpace)})`])}or(...e){return null==e||0===e.length?new fe([...this.query,ie.Or]):new De([...this.query,ie.Or,`(${e.map(e=>e.toString()).join(ie.OrWithSpace)})`])}toString(){return this.query.join(" ")}}class Ie{constructor(e=""){this._root=W(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}function xe(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new Ie(e)}function Ce(e){if(u(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substring(0,t):e}function Oe(e){const t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(m(e,n[0])&&"SP.Web"===e[n[0]])m(e,n[4])?t.push(e[n[4]]):m(e,n[2])&&t.push(e.__metadata.uri);else if(m(e,n[3])&&m(e,n[1])){const a=l(e[n[1]])?e[n[1]].split("_api")[1]:e[n[1]];t.push(Ce(e[n[3]]),"_api",a)}else m(e,n[1])?t.push("_api",e[n[1]]):m(e,n[2])&&t.push(e.__metadata.uri);return t.length<1?"":i(...t)}function we(e){return u(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${n.replace(/'/gi,"''")}`):encodeURIComponent(e.replace(/'/gi,"''"))}function Ee(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function Ae(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(re||(re={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(oe||(oe={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(se||(se={})),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let Le=class extends q{async add(e,t,n="",a="STS",i=1033,r=!0){const o=V({parameters:{Description:n,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:r,WebTemplate:a}});return $(ke(this,"add"),o)}};Le=Ee([Ae("webs")],Le);const ke=G(Le);function Me(e,t){let n="_api/web";const a=/(_api[/|\\](site\/rootweb|site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=Ce(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=i(e,n)),e}let Pe=class extends Y{constructor(e,t){super(e="string"==typeof e?Me(e,t):d(e)?[e[0],Me(e[1],t)]:[e,Me(e.toUrl(),t)],t),this.delete=X()}get webs(){return ke(this)}get allProperties(){return J(this,"allproperties")}get webinfos(){return Q(this,"webinfos")}async getParentWeb(){const{Url:e,ParentWeb:t}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return(null==t?void 0:t.ServerRelativeUrl)?Te([this,i(new URL(e).origin,t.ServerRelativeUrl)]):null}async update(e){return ee(this,V(e))}applyTheme(e,t,n,a){const i=V({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:a});return $(Te(this,"applytheme"),i)}applyWebTemplate(e){return $(Te(this,`applywebtemplate(webTemplate='${we(e)}')`))}getChanges(e){return $(Te(this,"getchanges"),V({query:e}))}mapToIcon(e,t=0,n=""){return Te(this,`maptoicon(filename='${we(e)}',progid='${we(n)}',size=${t})`)()}getStorageEntity(e){return Te(this,`getStorageEntity('${we(e)}')`)()}setStorageEntity(e,t,n="",a=""){return $(Te(this,"setStorageEntity"),V({comments:a,description:n,key:e,value:t}))}removeStorageEntity(e){return $(Te(this,`removeStorageEntity('${we(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return Q(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}availableWebTemplates(e=1033,t=!0){return Q(this,`getavailablewebtemplates(lcid=${e},doincludecrosslanguage=${t})`)}};Pe=Ee([Ae("_api/web")],Pe);const Te=G(Pe);Ie.prototype.batched=function(e){const t=xe(this),[n,a]=Re(t._root,e);return t.using(n),[t,a]},Pe.prototype.batched=function(e){const t=Te(this),[n,a]=Re(t,e);return t.using(n),[t,a]};const Ue=Symbol.for("batch_registration"),Fe=Symbol.for("batch_request");class He extends K{constructor(e,t=e.toUrl().replace(/_api[\\|/].*$/i,"")){super(t,"_api/$batch"),this.requestBaseUrl=t,this.using(E(e,"replace"),N(async e=>function(e){const t=[],n="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let r,o,s="batch",c={};const d=[];for(let e=0;e<i.length;++e){let l=i[e];switch(s){case"batch":if(l.substring(0,16)===n)s="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(s="status");break;case"status":{const t=a.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);r=parseInt(t[1],10),o=t[2],s="statusHeaders";break}case"statusHeaders":if(""===l.trim())s="body";else{const e=l.split(":");2===(null==e?void 0:e.length)&&(c[e[0].trim()]=e[1].trim())}break;case"body":for(d.length=0;l.substring(0,16)!==n;)d.push(l),l=i[++e];e--,t.push(new Response(204===r?null:d.join(""),{status:r,statusText:o,headers:c})),s="batch",c={}}}if("status"!==s)throw Error("Unexpected end of input");return t}(await e.text()))),this.on.dispose(()=>{e.using(E(this,"replace",e=>/(auth|send|pre|init)/i.test(e)))})}}function Re(e,t){const n=[],a=[],o=[],s=new He(e),d=r(),u=new He(e),{headersCopyPattern:f,maxRequests:p}={headersCopyPattern:/Accept|Content-Type|IF-Match/i,maxRequests:20,...t};return[e=>(e.on.init(function(){if(c(this[Ue]))throw Error("This instance is already part of a batch. Please review the docs at https://pnp.github.io/pnpjs/concepts/batching#reuse.");return n.push(new Promise(e=>{this[Ue]=e})),this}),e.on.pre(async function(e,t,n){return m(t.headers,"X-PnP-BatchNever")?("function"==typeof this[Fe]&&(this[Fe](),delete this[Fe]),this.using(E(u,"replace",e=>/(init|pre)/i.test(e))),[e,t,n]):(this.on.auth.clear(),this.on.send.replace(async function(e,t){const n=new Promise(n=>{o.push([this,e.toString(),t,n])});return this.log(`[batch:${d}] (${(new Date).getTime()}) Adding request ${t.method} ${e.toString()} to batch.`,0),a.push(new Promise(e=>{this[Fe]=e})),this[Ue](),n}),this.on.dispose(function(){c(this[Ue])&&(this[Ue](),delete this[Ue]),c(this[Fe])&&(this[Fe](),delete this[Fe],this.using(E(u,"replace",e=>/(auth|pre|send|init|dispose)/i.test(e))))}),[e,t,n])}),e),async()=>{if(await Promise.all(n),o.length<1)return Promise.all(a).then(()=>{});const e=o.slice();for(;e.length>0;){const t=e.splice(0,p),n=[];let a="";for(let e=0;e<t.length;e++){const[,o,c]=t[e];"GET"===c.method?(a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${d}\n`)):(a.length<1&&(a=r(),n.push(`--batch_${d}\n`),n.push(`Content-Type: multipart/mixed; boundary="changeset_${a}"\n\n`)),n.push(`--changeset_${a}\n`)),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");const u=new Headers(c.headers),p=l(o)?o:i(s.requestBaseUrl,o);if("GET"!==c.method){let e=c.method;u.has("X-HTTP-Method")&&(e=u.get("X-HTTP-Method"),u.delete("X-HTTP-Method")),n.push(`${e} ${p} HTTP/1.1\n`)}else n.push(`${c.method} ${p} HTTP/1.1\n`);u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;charset=utf-8"),u.forEach((e,t)=>{f.test(t)&&n.push(`${t}: ${e}\n`)}),n.push("\n"),c.body&&n.push(`${c.body}\n\n`)}a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${d}--\n`);const o=await $(s,{body:n.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${d}`}});if(o.length!==t.length)throw Error("Could not properly parse responses to match requests in batch.");for(let e=0;e<o.length;e++)t[e][3](o[e])}await Promise.all(a).then(()=>{})}]}function Ne(e){const t=new Date;return!f(e)||t>e.expiration?null:e}const Be=new Map;class je extends Error{constructor(e){super(`SPFx Context supplied to ${e} Behavior is null or undefined.`)}static check(e,t){if(null==t)throw new je(e)}}function Ve(e){return je.check("SPFx",e),t=>{return t.using(e=>(e.using(function(e,t=!1){return n=>{const a=async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]};return t?n.on.pre.prepend(a):n.on.pre(a),n}}({Accept:"application/json","Content-Type":"application/json;charset=utf-8"})),e),e=>(e.on.pre(async(e,t,n)=>(t.cache="no-cache",t.credentials="same-origin",[e,t,n])),e.using(e=>(e.on.pre(async function(e,t,n){let a="PnPCoreJS:4.16.0:";const{pathname:i}=new URL(e);return a=i.split("/").filter(e=>!u(e)&&["_api","v2.1","v2.0"].indexOf(e)<0).map((e,t,n)=>t===n.length-1?e.replace(/\(.*?$/i,"()"):e[0]).join("."),a.length>32&&(a=a.substring(0,32)),this.log(`Request Tag: ${a}`,0),t.headers={...t.headers,"X-ClientService-ClientTag":a},[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalReject](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolve](e)}),e)),e),function(){const{interval:e,replace:t,retries:n}={replace:!0,interval:200,retries:3};return a=>(t&&a.on.send.clear(),a.on.send(function(t,a){let i,r,o=e,s=0;const c=async()=>{if(s>=n)throw r||new B(`Retry count exceeded (${n}) for this request. ${i.status}: ${i.statusText};`,i);if(s++,void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?o=1e3*parseInt(i.headers.get("Retry-After"),10):o*=2,this.log(`Attempt #${s} to retry request which failed with ${i.status}: ${i.statusText}`,0),await(e=o,new Promise(t=>{setTimeout(t,e)})));try{const e=t.toString();return this.log(`Fetch: ${a.method} ${e}`,0),i=await fetch(e,a),i.ok?i:c()}catch(e){if(/AbortError/.test(e.name))throw e;return r=e,c()}var e};return c()}),a)}(),N(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return R(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),(n=t=>{var n,r,o;if(new RegExp(`^${i(e.pageContext.web.absoluteUrl,"/_api")}`,"i").test(t)&&(null===(r=null===(n=null==e?void 0:e.pageContext)||void 0===n?void 0:n.legacyPageContext)||void 0===r?void 0:r.formDigestValue)){const t=new Date(e.pageContext.legacyPageContext.formDigestValue.split(",")[1]);return{value:e.pageContext.legacyPageContext.formDigestValue,expiration:a(t,"second",(null===(o=e.pageContext.legacyPageContext)||void 0===o?void 0:o.formDigestTimeoutSeconds)-15||1585)}}},e=>(e.on.pre(async function(e,t,r){return this.on.auth(async(e,t)=>{if(/get/i.test(t.method)||t.headers&&(m(t.headers,"X-RequestDigest")||m(t.headers,"Authorization")||m(t.headers,"X-PnPjs-NoDigest")))return[e,t];const r=e.toString(),o=Ce(r);let s=Ne(Be.get(o));return!f(s)&&c(n)&&(s=Ne(n(r))),f(s)||(s=await $(W([this,i(o,"_api/contextinfo")]).using(N(e=>e.json()),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)),{headers:{Accept:"application/json","X-PnPjs-NoDigest":"1"}}).then(e=>({expiration:a(new Date,"second",e.FormDigestTimeoutSeconds),value:e.FormDigestValue}))),f(s)&&(t.headers={"X-RequestDigest":s.value,...t.headers},Be.set(o,s)),[e,t]}),[e,t,r]}),e))),t.on.pre.prepend(async(t,n,a)=>(l(t)||(t=i(e.pageContext.web.absoluteUrl,t)),[t,n,a])),t;var n}}function ze(e){return{DecodedUrl:e}}Reflect.defineProperty(Ie.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(Te)}});let Ge=class extends q{getById(e){return qe(this).concat(`('${e}')`)}getByTitle(e){return qe(this,`getByTitle('${we(e)}')`)}async add(e,t="",n=100,a=!1,i={}){const r={AllowContentTypes:a,BaseTemplate:n,ContentTypesEnabled:a,Description:t,Title:e,...i};return $(this,V(r))}async ensure(e,t="",n=100,a=!1,i={}){const r={Title:e,Description:t,ContentTypesEnabled:a,...i},o=this.getByTitle(r.Title);try{return await o.select("Title")(),{created:!1,data:await o.update(r),list:this.getByTitle(r.Title)}}catch(i){return{created:!0,data:await this.add(e,t,n,a,r),list:this.getByTitle(r.Title)}}}async ensureSiteAssetsLibrary(){const e=await $(Ke(this,"ensuresiteassetslibrary"));return qe([this,Oe(e)])}async ensureSitePagesLibrary(){const e=await $(Ke(this,"ensuresitepageslibrary"));return qe([this,Oe(e)])}};Ge=Ee([Ae("lists")],Ge);const Ke=G(Ge);class We extends Y{constructor(){super(...arguments),this.delete=Z()}get effectiveBasePermissions(){return W(this,"EffectiveBasePermissions")}get eventReceivers(){return Q(this,"EventReceivers")}get relatedFields(){return W(this,"getRelatedFields")}get informationRightsManagementSettings(){return W(this,"InformationRightsManagementSettings")}async update(e,t="*"){return await ee(this,V(e,z({"IF-Match":t})))}getChanges(e){return $(qe(this,"getchanges"),V({query:e}))}getItemsByCAMLQuery(e,...t){return $(qe(this,"getitems").expand(...t),V({query:e}))}getListItemChangesSinceToken(e){return $(qe(this,"getlistitemchangessincetoken").using(N(e=>e.text())),V({query:e}))}async recycle(){return $(qe(this,"recycle"))}async renderListData(e){const t=qe(this,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const n=await $(t);return JSON.parse(n)}renderListDataAsStream(e,t=null,n=new Map){m(e,"RenderOptions")&&d(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));const a=qe(this,"RenderListDataAsStream");n&&n.size>0&&n.forEach((e,t)=>a.query.set(t,e));const i=f(t)?{parameters:e,overrideParameters:t}:{parameters:e};return $(a,V(i))}async renderListFormData(e,t,n){const a=await $(qe(this,`renderlistformdata(itemid=${e}, formid='${t}', mode='${n}')`));return JSON.parse(a)}async reserveListItemId(){return $(qe(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(e,t,n=!1,a,i){const r={FolderPath:ze(t)};return f(i)&&(i.leafName&&(r.LeafName=ze(i.leafName)),i.objectType&&(r.UnderlyingObjectType=i.objectType)),$(qe(this,"AddValidateUpdateItemUsingPath()"),V({bNewDocumentUpdate:n,checkInComment:a,formValues:e,listItemCreateInfo:r}))}async getParentInfos(){const e=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}}const qe=G(We);var Qe,Ye;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest",e[e.ListAvailableContentTypes=65536]="ListAvailableContentTypes",e[e.FolderContentTypeOrder=131072]="FolderContentTypeOrder",e[e.GridInitInfo=262144]="GridInitInfo",e[e.SiteUrlAsMediaTASPItemHost=524288]="SiteUrlAsMediaTASPItemHost",e[e.AddToOneDrive=1048576]="AddToOneDrive",e[e.SPFXCustomActions=2097152]="SPFXCustomActions",e[e.CustomActions=4194304]="CustomActions"}(Qe||(Qe={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(Ye||(Ye={})),j(Pe,"lists",Ke),j(Pe,"siteUserInfoList",qe),j(Pe,"defaultDocumentLibrary",qe),j(Pe,"customListTemplates",Q,"getcustomlisttemplates"),Pe.prototype.getList=function(e){return qe(this,`getList('${we(e)}')`)},Pe.prototype.getCatalog=async function(e){const t=await Te(this,`getcatalog(${e})`).select("Id")();return qe([this,Oe(t)])};let Je=class extends q{getById(e){return Ze(this).concat(`(${e})`)}getItemByStringId(e){return Ze([this,this.parentUrl],`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`):this.query.set("$skiptoken",`Paged=TRUE&p_ID=${e}`),this}[Symbol.asyncIterator](){const e=Q(this).using(N(async e=>{const t=await e.json(),n=m(t,"d")&&m(t.d,"__next")?t.d.__next:t["odata.nextLink"];return{hasNext:"string"==typeof n&&n.length>0,nextLink:n,value:R(t)}})),t=["$top","$select","$expand","$filter","$orderby","$skiptoken"];for(let n=0;n<t.length;n++){const a=this.query.get(t[n]);f(a)&&e.query.set(t[n],a)}return{_next:e,async next(){if(null===this._next)return{done:!0,value:void 0};const e=await this._next();return e.hasNext?(this._next=Q([this._next,e.nextLink]),{done:!1,value:e.value}):(this._next=null,{done:!1,value:e.value})}}}async add(e={}){return $(this,V(e))}};Je=Ee([Ae("items")],Je);const Xe=G(Je),Ze=G(class extends Y{constructor(){super(...arguments),this.delete=Z()}get effectiveBasePermissions(){return W(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return W(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return J(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return J(this,"FieldValuesAsText")}get fieldValuesForEdit(){return J(this,"FieldValuesForEdit")}get versions(){return et(this)}get list(){return this.getParent(qe,"",this.parentUrl.substring(0,this.parentUrl.lastIndexOf("/")))}async update(e,t="*"){const n=V(e,z({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return $(Ze(this).using(N(async e=>({etag:e.headers.get("etag")}))),n)}recycle(){return $(Ze(this,"recycle"))}async deleteWithParams(e){return $(Ze(this,"DeleteWithParameters"),V({parameters:e}))}async getWopiFrameUrl(e=0){const t=Ze(this,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),$(t)}validateUpdateListItem(e,t=!1){return $(Ze(this,"validateupdatelistitem"),V({formValues:e,bNewDocumentUpdate:t}))}async getParentInfos(){const e=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,Title:e.ParentList.Title,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}async setImageField(e,t,n){const a=await this.getParentInfos(),i=Ce(this.toUrl()),r=W([this,i],"/_api/web/UploadImage");r.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),r.query.set("@a1",`'${a.ParentList.Title}'`),r.query.set("@a2",`'${t}'`),r.query.set("@a3",`'${a.ParentList.Id}'`),r.query.set("@a4",a.Item.Id);const o=await $(r,{body:n}),s={type:"thumbnail",fileName:o.Name,nativeFile:{},fieldName:e,serverUrl:a.ParentWeb.Url.replace(a.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:o.ServerRelativeUrl,id:o.UniqueId};return this.validateUpdateListItem([{FieldName:e,FieldValue:JSON.stringify(s)}])}});let $e=class extends q{getById(e){return tt(this).concat(`(${e})`)}};$e=Ee([Ae("versions")],$e);const et=G($e),tt=G(class extends Y{constructor(){super(...arguments),this.delete=Z()}});j(We,"items",Xe);let nt=class extends q{getById(e){return it(this).concat(`(${e})`)}async add(e){return $(this,V(e))}getByName(e){return it(this,`getByName('${e}')`)}removeById(e){return $(at(this,`removeById('${e}')`))}removeByLoginName(e){return $(at(this,`removeByLoginName('${e}')`))}};nt=Ee([Ae("sitegroups")],nt);const at=G(nt),it=G(class extends Y{get users(){return ot(this,"users")}async update(e){return ee(this,V(e))}setUserAsOwner(e){return $(it(this,`SetUserAsOwner(${e})`))}});let rt=class extends q{getById(e){return st(this,`getById(${e})`)}getByEmail(e){return st(this,`getByEmail('${e}')`)}getByLoginName(e){return st(this).concat(`('!@v::${e}')`)}removeById(e){return $(ot(this,`removeById(${e})`))}removeByLoginName(e){const t=ot(this,"removeByLoginName(@v)");return t.query.set("@v",`'${e}'`),$(t)}async add(e){return await $(this,V({LoginName:e})),this.getByLoginName(e)}};rt=Ee([Ae("siteusers")],rt);const ot=G(rt),st=G(class extends Y{constructor(){super(...arguments),this.delete=X()}get groups(){return at(this,"groups")}async update(e){return ee(this,V(e))}});j(Pe,"siteUsers",ot),j(Pe,"currentUser",st),Pe.prototype.ensureUser=async function(e){return $(Te(this,"ensureuser"),V({logonName:e}))},Pe.prototype.getUserById=function(e){return st(this,`getUserById(${e})`)};let ct=class extends q{async createFieldAsXml(e){return"string"==typeof e&&(e={SchemaXml:e}),$(dt(this,"createfieldasxml"),V({parameters:e}))}getById(e){return lt(this).concat(`('${e}')`)}getByTitle(e){return lt(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return lt(this,`getByInternalNameOrTitle('${e}')`)}async add(e,t,n){return $(dt(this,null),V(Object.assign({__metadata:{type:null!==(a=ft[t])&&void 0!==a?a:"SP.Field"}},{Title:e,FieldTypeKind:t,...n}),z({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"})));var a}async addField(e,t,n){return $(dt(this,"AddField"),V({parameters:{Title:e,FieldTypeKind:t,...n}}))}addText(e,t){return this.add(e,2,{MaxLength:255,...t})}addCalculated(e,t){return this.add(e,17,{OutputType:ut.Text,...t})}addDateTime(e,t){return this.add(e,4,{DateTimeCalendarType:ht.Gregorian,DisplayFormat:pt.DateOnly,FriendlyDisplayFormat:mt.Unspecified,...t})}addNumber(e,t){return this.add(e,9,t)}addCurrency(e,t){return this.add(e,10,{CurrencyLocaleId:1033,...t})}addMultilineText(e,t){return this.add(e,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...t})}addUrl(e,t){return this.add(e,11,{DisplayFormat:bt.Hyperlink,...t})}addUser(e,t){return this.add(e,20,{SelectionMode:gt.PeopleAndGroups,...t})}async addLookup(e,t){return this.addField(e,7,t)}addChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,6,n)}addMultiChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,15,n)}addBoolean(e,t){return this.add(e,8,t)}async addDependentLookupField(e,t,n){return $(dt(this,`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${n}')`))}addLocation(e,t){return this.add(e,33,t)}addImageField(e,t){return this.add(e,34,t)}};ct=Ee([Ae("fields")],ct);const dt=G(ct),lt=G(class extends Y{constructor(){super(...arguments),this.delete=X()}async update(e,t){return null==t&&(t=(await lt(this).select("FieldTypeKind")())["odata.type"]),ee(this,V(e))}setShowInDisplayForm(e){return $(lt(this,`setshowindisplayform(${e})`))}setShowInEditForm(e){return $(lt(this,`setshowineditform(${e})`))}setShowInNewForm(e){return $(lt(this,`setshowinnewform(${e})`))}});var ut;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType",e[e.Location=33]="Location",e[e.Image=34]="Image"}(ut||(ut={}));const ft={[ut.Calculated]:"SP.FieldCalculated",[ut.Choice]:"SP.FieldChoice",[ut.Computed]:"SP.FieldComputed",[ut.Currency]:"SP.FieldCurrency",[ut.DateTime]:"SP.FieldDateTime",[ut.GridChoice]:"SP.FieldRatingScale",[ut.Guid]:"SP.FieldGuid",[ut.Image]:"SP.FieldMultiLineText",[ut.Integer]:"SP.FieldNumber",[ut.Location]:"SP.FieldLocation",[ut.Lookup]:"SP.FieldLookup",[ut.ModStat]:"SP.FieldChoice",[ut.MultiChoice]:"SP.FieldMultiChoice",[ut.Note]:"SP.FieldMultiLineText",[ut.Number]:"SP.FieldNumber",[ut.Text]:"SP.FieldText",[ut.URL]:"SP.FieldUrl",[ut.User]:"SP.FieldUser",[ut.WorkflowStatus]:"SP.FieldChoice",[ut.WorkflowEventType]:"SP.FieldNumber"};var pt,mt,_t,ht,bt,gt,vt;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(pt||(pt={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(mt||(mt={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(_t||(_t={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(ht||(ht={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(bt||(bt={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(gt||(gt={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(vt||(vt={})),j(Pe,"fields",dt),j(Pe,"availablefields",dt),j(We,"fields",dt);var yt=o(982);class St extends n.BaseClientSideWebPart{constructor(){super(...arguments),this.teamMembers=[],this.currentEditingId=null,this.branchOptions=[],this.branch1InternalName="Branch1ENG",this.branch2InternalName="Branch2ENG",this.branch3InternalName="Branch3ENG"}async render(){try{console.log("üîÑ Starting Team Leader Profile render...");const e=xe().using(Ve(this.context)),t=await e.web.currentUser();console.log("‚úÖ Current team leader:",t),await this.getBranchFieldInternalNames(e);try{this.branchOptions=await e.web.lists.getByTitle("Branch Names").items.select("ID","Title","BranchNameENG")(),console.log("‚úÖ Branch options:",this.branchOptions)}catch(e){console.error("‚ùå Error fetching branch options:",e),this.branchOptions=[]}const n=["ID","Title","UserName/Id","UserName/Title","Code","Department/Title","SubSpeciality","ArmyStatus","StartDate1","StartDate2","StartDate3","Shift1","Shift2","Shift3","Revenue","Degree","Name_x002d_EN","Name_x002d_AR","Specialty","Email","Phone","DateofBirth","MaritalStatus","Exclusive","Bio","BioEN","CertificationInfo","Branch1Managedby/Id","Branch1Managedby/Title","Branch1Managedby/EMail","Branch2Managedby/Id","Branch2Managedby/Title","Branch2Managedby/EMail","Branch3Managedby/Id","Branch3Managedby/Title","Branch3Managedby/EMail",`${this.branch1InternalName}/Id`,`${this.branch1InternalName}/Title`,`${this.branch2InternalName}/Id`,`${this.branch2InternalName}/Title`,`${this.branch3InternalName}/Id`,`${this.branch3InternalName}/Title`];console.log("üîç Select fields:",n);const a=await e.web.lists.getByTitle("Employee Details").items.select(...n).expand("UserName","Department","Branch1Managedby","Branch2Managedby","Branch3Managedby",this.branch1InternalName,this.branch2InternalName,this.branch3InternalName)();console.log("‚úÖ All items from list:",a);const i=t.Id,r=t.Email.toLowerCase();if(this.teamMembers=a.filter(e=>{const n=e.Branch1Managedby,a=e.Branch2Managedby,o=e.Branch3Managedby,s=n&&(n.Id===i||n.EMail&&n.EMail.toLowerCase()===r),c=a&&(a.Id===i||a.EMail&&a.EMail.toLowerCase()===r),d=o&&(o.Id===i||o.EMail&&o.EMail.toLowerCase()===r),l=s||c||d;return console.log(`üîç Employee: ${e.Name_x002d_EN}, Branch1 Manager: ${n?`${n.Title} (${n.EMail})`:"None"}, Branch2 Manager: ${a?`${a.Title} (${a.EMail})`:"None"}, Branch3 Manager: ${o?`${o.Title} (${o.EMail})`:"None"}, Current User: ${t.Title} (${t.Email}), Is Managed: ${l}`),l}),console.log("‚úÖ Filtered team members:",this.teamMembers),0===this.teamMembers.length)return void(this.domElement.innerHTML=`\n          <div style="font-family: Arial, sans-serif; padding: 20px;">\n            <h2 style="color: #2c3e50;">Team Management</h2>\n            <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; color: #856404;">\n              <p><strong>No team members found.</strong></p>\n              <p>You are not listed as a manager for any branch, or there are no employee records in the system.</p>\n              <p><strong>Your User:</strong> ${t.Title} (ID: ${t.Id}, Email: ${t.Email})</p>\n              <p><strong>Total Employees in System:</strong> ${a.length}</p>\n              <div style="margin-top: 10px; font-size: 14px;">\n                <p><strong>Note:</strong> You need to be assigned as a Person in one of these fields for each employee:</p>\n                <ul style="margin: 5px 0; padding-left: 20px;">\n                  <li>Branch1Managedby</li>\n                  <li>Branch2Managedby</li>\n                  <li>Branch3Managedby</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        `);const o=e=>{if(!e)return"-";if(e.Title)return e.Title;if(e.Id&&this.branchOptions.length>0){const t=this.branchOptions.find(t=>t.ID===e.Id);if(t)return t.BranchNameENG||t.Title||`Branch ${e.Id}`}return e.Id?`Branch ${e.Id}`:"-"},s=e=>null==e||""===e?"-":"object"==typeof e?e.Title||e.Value||JSON.stringify(e):e,c=e=>{if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?"Invalid date":t.toLocaleDateString()}catch(t){return String(e)}},d=e=>null==e?"-":e?"Yes":"No";let l=`\n        <div style="font-family: Arial, sans-serif; max-width: 2200px; margin: 0 auto;">\n          <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">Team Management</h2>\n          <p style="color: #7f8c8d;">Welcome, <strong>${t.Title}</strong>. You can manage schedule and branch information for your employees below.</p>\n          <p style="color: #27ae60; font-weight: bold;">üìä Team Members: ${this.teamMembers.length}</p>\n          <div style="padding: 10px; background: #e8f5e8; border-radius: 4px; margin-bottom: 15px; border: 1px solid #c8e6c9;">\n            <strong>‚úÖ Branch Filter Applied:</strong> Showing employees where you are assigned as manager in Branch1Managedby, Branch2Managedby, or Branch3Managedby Person fields.\n          </div>\n          \n          <div style="overflow-x: auto; margin-top: 20px;">\n            <table style="width: 100%; border-collapse: collapse; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); font-size: 10px;">\n              <thead>\n                <tr style="background: #34495e; color: white;">\n                  \x3c!-- Basic Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Code</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Name (EN)</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Name (AR)</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Degree</th>\n                  \n                  \x3c!-- Contact Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Email</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Phone</th>\n                  \n                  \x3c!-- Department & Role --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Department</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Specialty</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Sub Specialty</th>\n                  \n                  \x3c!-- Personal Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Date of Birth</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Marital Status</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Army Status</th>\n                  \n                  \x3c!-- Professional Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Exclusive</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Revenue</th>\n                  \n                  \x3c!-- Branch ENG Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Branch 1 ENG</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Branch 2 ENG</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Branch 3 ENG</th>\n                  \n                  \x3c!-- Bio Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Bio</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Bio EN</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Certification Info</th>\n                  \n                  \x3c!-- Schedule Information --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Start Date 1</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Start Date 2</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Start Date 3</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Shift 1</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Shift 2</th>\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Shift 3</th>\n                  \n                  \x3c!-- Actions --\x3e\n                  <th style="padding: 6px; text-align: left; border: 1px solid #2c3e50;">Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n      `;this.teamMembers.forEach(e=>{const t=e[this.branch1InternalName],n=e[this.branch2InternalName],a=e[this.branch3InternalName];l+=`\n          <tr style="border-bottom: 1px solid #ecf0f1;">\n            \x3c!-- Basic Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Code)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;"><strong>${s(e.Name_x002d_EN)}</strong></td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Name_x002d_AR)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Degree)}</td>\n            \n            \x3c!-- Contact Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Email)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Phone)}</td>\n            \n            \x3c!-- Department & Role --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Department)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Specialty)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.SubSpeciality)}</td>\n            \n            \x3c!-- Personal Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${c(e.DateofBirth)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.MaritalStatus)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.ArmyStatus)}</td>\n            \n            \x3c!-- Professional Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${d(e.Exclusive)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Revenue)}</td>\n            \n            \x3c!-- Branch ENG Information - USING SAME CONCEPT AS MYPROFILE --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${o(t)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${o(n)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${o(a)}</td>\n            \n            \x3c!-- Bio Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1; max-width: 100px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${s(e.Bio)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1; max-width: 100px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${s(e.BioEN)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1; max-width: 100px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${s(e.CertificationInfo)}</td>\n            \n            \x3c!-- Schedule Information --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${c(e.StartDate1)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${c(e.StartDate2)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${c(e.StartDate3)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Shift1)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Shift2)}</td>\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">${s(e.Shift3)}</td>\n            \n            \x3c!-- Actions --\x3e\n            <td style="padding: 6px; border: 1px solid #ecf0f1;">\n              <button class="editBtn" data-id="${e.ID}" style="padding: 4px 8px; background: #3498db; color: white; border: none; cursor: pointer; border-radius: 4px; font-size: 9px; width: 100%;">\n                Edit Schedule & Branches\n              </button>\n            </td>\n          </tr>\n        `}),l+='\n              </tbody>\n            </table>\n          </div>\n          \n          \x3c!-- Edit Modal --\x3e\n          <div id="editModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">\n            <div id="modalDialog" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 8px; width: 95%; max-width: 900px; max-height: 90vh; overflow-y: auto;">\n              <h3 style="color: #2c3e50; margin-bottom: 20px;">Edit Employee Schedule & Branch Information</h3>\n              <div id="modalContent"></div>\n              <div style="margin-top: 25px; text-align: right;">\n                <button id="cancelBtn" style="padding: 10px 20px; background: #95a5a6; color: white; border: none; cursor: pointer; border-radius: 4px; margin-right: 10px;">Cancel</button>\n                <button id="saveModalBtn" style="padding: 10px 20px; background: #27ae60; color: white; border: none; cursor: pointer; border-radius: 4px;">Save Changes</button>\n              </div>\n              <div id="modalMessage" style="margin-top: 15px; padding: 10px; border-radius: 4px;"></div>\n            </div>\n          </div>\n        </div>\n      ',this.domElement.innerHTML=l,this.attachEventHandlers(),console.log("‚úÖ Team Leader Profile web part rendered successfully")}catch(e){console.error("‚ùå Error in Team Leader Profile render:",e),this.domElement.innerHTML=`\n        <div style="padding: 20px; color: #e74c3c; background: #fadbd8; border: 1px solid #e74c3c; border-radius: 4px;">\n          <h2>Error</h2>\n          <p><strong>Message:</strong> ${e.message}</p>\n          <p>Check browser console for details.</p>\n        </div>\n      `}}async getBranchFieldInternalNames(e){try{try{const t=await e.web.lists.getByTitle("Employee Details").fields.getByTitle("Branch1ENG")();this.branch1InternalName=t.InternalName,console.log("‚úÖ Branch1ENG field details:",{Title:t.Title,InternalName:t.InternalName,TypeAsString:t.TypeAsString,LookupList:t.LookupList,LookupField:t.LookupField})}catch(e){console.error("‚ùå Error getting internal name for Branch1ENG, using default",e)}try{const t=await e.web.lists.getByTitle("Employee Details").fields.getByTitle("Branch2ENG")();this.branch2InternalName=t.InternalName,console.log("‚úÖ Branch2ENG field details:",{Title:t.Title,InternalName:t.InternalName,TypeAsString:t.TypeAsString,LookupList:t.LookupList,LookupField:t.LookupField})}catch(e){console.error("‚ùå Error getting internal name for Branch2ENG, using default",e)}try{const t=await e.web.lists.getByTitle("Employee Details").fields.getByTitle("Branch3ENG")();this.branch3InternalName=t.InternalName,console.log("‚úÖ Branch3ENG field details:",{Title:t.Title,InternalName:t.InternalName,TypeAsString:t.TypeAsString,LookupList:t.LookupList,LookupField:t.LookupField})}catch(e){console.error("‚ùå Error getting internal name for Branch3ENG, using default",e)}}catch(e){console.error("‚ùå Error getting branch field internal names:",e)}}attachEventHandlers(){const e=this.domElement.querySelectorAll(".editBtn"),t=document.getElementById("editModal"),n=document.getElementById("modalDialog"),a=document.getElementById("modalContent"),i=document.getElementById("modalMessage"),r=document.getElementById("cancelBtn"),o=document.getElementById("saveModalBtn");e.forEach(e=>{e.replaceWith(e.cloneNode(!0))}),this.domElement.querySelectorAll(".editBtn").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const n=e.target,r=parseInt(n.getAttribute("data-id"));this.currentEditingId=r;const o=this.teamMembers.find(e=>e.ID===r);if(!o)return;const s=e=>null==e||""===e?"":"object"==typeof e?e.Title||"":e,c=e=>{let t='<option value="">-- Select Branch --</option>';return this.branchOptions.forEach(n=>{const a=e&&e.Id===n.ID?"selected":"",i=n.BranchNameENG||n.Title;t+=`<option value="${n.ID}" ${a}>${i}</option>`}),t},d=o[this.branch1InternalName],l=o[this.branch2InternalName],u=o[this.branch3InternalName];a.innerHTML=`\n          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">\n            \x3c!-- Column 1: Basic Information --\x3e\n            <div>\n              <h4 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #bdc3c7; padding-bottom: 5px;">Basic Information</h4>\n              <div style="margin-bottom: 8px;"><strong>Code:</strong> ${s(o.Code)}</div>\n              <div style="margin-bottom: 8px;"><strong>Name (EN):</strong> ${s(o.Name_x002d_EN)}</div>\n              <div style="margin-bottom: 8px;"><strong>Name (AR):</strong> ${s(o.Name_x002d_AR)}</div>\n              <div style="margin-bottom: 8px;"><strong>Degree:</strong> ${s(o.Degree)}</div>\n              <div style="margin-bottom: 8px;"><strong>Department:</strong> ${s(o.Department)}</div>\n            </div>\n            \n            \x3c!-- Column 2: Contact & Professional --\x3e\n            <div>\n              <h4 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #bdc3c7; padding-bottom: 5px;">Contact & Professional</h4>\n              <div style="margin-bottom: 8px;"><strong>Email:</strong> ${s(o.Email)}</div>\n              <div style="margin-bottom: 8px;"><strong>Phone:</strong> ${s(o.Phone)}</div>\n              <div style="margin-bottom: 8px;"><strong>Specialty:</strong> ${s(o.Specialty)}</div>\n              <div style="margin-bottom: 8px;"><strong>Sub Specialty:</strong> ${s(o.SubSpeciality)}</div>\n              <div style="margin-bottom: 8px;"><strong>Revenue:</strong> ${s(o.Revenue)}</div>\n            </div>\n          </div>\n          \n          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">\n            \x3c!-- Column 1: Personal Information --\x3e\n            <div>\n              <h4 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #bdc3c7; padding-bottom: 5px;">Personal Information</h4>\n              <div style="margin-bottom: 8px;"><strong>Date of Birth:</strong> ${o.DateofBirth?new Date(o.DateofBirth).toLocaleDateString():""}</div>\n              <div style="margin-bottom: 8px;"><strong>Marital Status:</strong> ${s(o.MaritalStatus)}</div>\n              <div style="margin-bottom: 8px;"><strong>Army Status:</strong> ${s(o.ArmyStatus)}</div>\n              <div style="margin-bottom: 8px;"><strong>Exclusive:</strong> ${o.Exclusive?"Yes":"No"}</div>\n            </div>\n            \n            \x3c!-- Column 2: Additional Information --\x3e\n            <div>\n              <h4 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #bdc3c7; padding-bottom: 5px;">Additional Information</h4>\n              <div style="margin-bottom: 8px;"><strong>Bio:</strong> ${s(o.Bio)||"N/A"}</div>\n              <div style="margin-bottom: 8px;"><strong>Bio EN:</strong> ${s(o.BioEN)||"N/A"}</div>\n              <div style="margin-bottom: 8px;"><strong>Certification Info:</strong> ${s(o.CertificationInfo)||"N/A"}</div>\n            </div>\n          </div>\n          \n          <div style="margin: 20px 0; padding: 15px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196f3;">\n            <strong>üè¢ Edit Branch Information:</strong>\n          </div>\n          \n          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Branch 1 ENG:</label>\n              <select id="modalBranch1ENG" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;">\n                ${c(d)}\n              </select>\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Branch 2 ENG:</label>\n              <select id="modalBranch2ENG" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;">\n                ${c(l)}\n              </select>\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Branch 3 ENG:</label>\n              <select id="modalBranch3ENG" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;">\n                ${c(u)}\n              </select>\n            </div>\n          </div>\n          \n          <div style="margin: 20px 0; padding: 15px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196f3;">\n            <strong>üìÖ Edit Schedule Information:</strong>\n          </div>\n          \n          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Start Date 1:</label>\n              <input type="date" id="modalStartDate1" value="${o.StartDate1?new Date(o.StartDate1).toISOString().split("T")[0]:""}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Start Date 2:</label>\n              <input type="date" id="modalStartDate2" value="${o.StartDate2?new Date(o.StartDate2).toISOString().split("T")[0]:""}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Start Date 3:</label>\n              <input type="date" id="modalStartDate3" value="${o.StartDate3?new Date(o.StartDate3).toISOString().split("T")[0]:""}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Shift 1:</label>\n              <input type="text" id="modalShift1" value="${s(o.Shift1)}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Shift 2:</label>\n              <input type="text" id="modalShift2" value="${s(o.Shift2)}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n            <div>\n              <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50;">Shift 3:</label>\n              <input type="text" id="modalShift3" value="${s(o.Shift3)}" style="padding: 8px; width: 100%; border: 1px solid #bdc3c7; border-radius: 4px;" />\n            </div>\n          </div>\n          \n          <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; border: 1px solid #dee2e6;">\n            <strong>‚ö†Ô∏è Note:</strong> You can edit schedule information (Start Dates and Shifts) and branch assignments (Branch ENG fields). Other employee details are managed by HR.\n          </div>\n        `,t.style.display="block",i.innerHTML=""})}),r.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),t.style.display="none",this.currentEditingId=null}),o.addEventListener("click",async e=>{if(e.preventDefault(),e.stopPropagation(),this.currentEditingId)try{const e=xe().using(Ve(this.context));o.disabled=!0,o.textContent="Saving...",o.style.background="#95a5a6",i.innerHTML="Saving changes...",i.style.color="#2980b9",i.style.backgroundColor="#d6eaf8",i.style.border="1px solid #3498db";const n={},a=document.getElementById("modalStartDate1").value,r=document.getElementById("modalStartDate2").value,s=document.getElementById("modalStartDate3").value;n.StartDate1=a?new Date(a).toISOString():null,n.StartDate2=r?new Date(r).toISOString():null,n.StartDate3=s?new Date(s).toISOString():null,n.Shift1=document.getElementById("modalShift1").value||null,n.Shift2=document.getElementById("modalShift2").value||null,n.Shift3=document.getElementById("modalShift3").value||null;const c=document.getElementById("modalBranch1ENG").value,d=document.getElementById("modalBranch2ENG").value,l=document.getElementById("modalBranch3ENG").value;console.log("üîç Branch selection values:",{branch1ENGValue:c,branch2ENGValue:d,branch3ENGValue:l}),console.log("üîç Internal names being used:",{branch1InternalName:this.branch1InternalName,branch2InternalName:this.branch2InternalName,branch3InternalName:this.branch3InternalName}),n[`${this.branch1InternalName}Id`]=c?parseInt(c):null,n[`${this.branch2InternalName}Id`]=d?parseInt(d):null,n[`${this.branch3InternalName}Id`]=l?parseInt(l):null,console.log("üîÑ Final update data being sent:",n);const u=await e.web.lists.getByTitle("Employee Details").items.getById(this.currentEditingId).update(n);console.log("‚úÖ Update result:",u);const f=await e.web.lists.getByTitle("Employee Details").items.getById(this.currentEditingId).select(`${this.branch1InternalName}/Id`,`${this.branch1InternalName}/Title`,`${this.branch2InternalName}/Id`,`${this.branch2InternalName}/Title`,`${this.branch3InternalName}/Id`,`${this.branch3InternalName}/Title`).expand(this.branch1InternalName,this.branch2InternalName,this.branch3InternalName)();console.log("‚úÖ Verified updated item branch fields:",{branch1ENG:f[this.branch1InternalName],branch2ENG:f[this.branch2InternalName],branch3ENG:f[this.branch3InternalName]}),i.innerHTML="‚úÖ Schedule and branch information updated successfully!",i.style.color="#27ae60",i.style.backgroundColor="#d5f4e6",i.style.border="1px solid #2ecc71",setTimeout(()=>{t.style.display="none",this.currentEditingId=null,this.render()},2e3)}catch(e){console.error("‚ùå Save error:",e);let t=`‚ùå Error saving: ${e.message}`;e.data&&(t+=`<br>Details: ${JSON.stringify(e.data)}`),e.status&&(t+=`<br>Status: ${e.status}`),i.innerHTML=t,i.style.color="#e74c3c",i.style.backgroundColor="#fadbd8",i.style.border="1px solid #e74c3c",o.textContent="Save Changes",o.disabled=!1,o.style.background="#27ae60"}}),t.addEventListener("click",e=>{e.target===t&&(t.style.display="none",this.currentEditingId=null)}),n.addEventListener("click",e=>{e.stopPropagation()})}async onInit(){return await super.onInit(),Promise.resolve()}onThemeChanged(e){}get dataVersion(){return e.Version.parse("1.0")}getPropertyPaneConfiguration(){return{pages:[{header:{description:yt.PropertyPaneDescription},groups:[{groupName:yt.BasicGroupName,groupFields:[(0,t.PropertyPaneTextField)("description",{label:yt.DescriptionFieldLabel})]}]}]}}}})(),s})());